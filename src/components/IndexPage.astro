---
import type { Page } from "astro";
import { type CollectionEntry } from "astro:content";
import BaseLayout from "../layouts/BaseLayout.astro";
import OS9Window from "./OS9Window.astro";
import PaginationBar from "./PaginationBar.astro";
import { SingleTheme } from "./singleTheme";
import { getEntries } from "astro:content";

interface Props {
  page: Pick<
    Page<CollectionEntry<"themes">>,
    "url" | "lastPage" | "currentPage" | "data"
  >;
}

const { page } = Astro.props;
---

<BaseLayout title={undefined}>
  <OS9Window asElement="main" title="Index">
    <PaginationBar slot="before-content" pagination={page} />
    <div class="themes-grid">
      {
        page.data
          .map((t) => t.data)
          .map(async (theme) => {
            const authors = (await getEntries(theme.authors)).map(
              (a) => a.data
            );
            return <SingleTheme theme={theme} authors={authors} />;
          })
      }
    </div>
    <PaginationBar slot="after-content" pagination={page} />
  </OS9Window>
</BaseLayout>
